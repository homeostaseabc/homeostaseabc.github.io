System.register(["./chunk-vendor.js","./chunk-frameworks.js"],(function(){"use strict";var e,s,t,r;return{setters:[function(r){e=r._,s=r.t,t=r.c},function(e){r=e.c}],execute:function(){let a=class PresenceAvatars extends HTMLElement{constructor(){super(...arguments),this.avatarsByUserId=new Map,this.usersPresent=new Set}connectedCallback(){const e=this.avatar.parentElement,s=this.avatar;if(s.hidden=!0,this.hidden=!1,!e)return;for(const r of Array.from(e.children))r!==s&&e.removeChild(r);this.classList.add("js-socket-channel");const t=t=>{if(!this.usersPresent.has(t)){this.usersPresent.add(t);try{const r=s.cloneNode(!0);r.src=r.src.replace(/u\/[0-9]+/,"u/"+t),r.setAttribute("data-hovercard-url","/hovercards?user_id="+t),r.hidden=!1,r.removeAttribute("data-target"),null==e||e.appendChild(r),this.avatarsByUserId.set(t,r)}catch(r){this.usersPresent.delete(t)}}},a=s=>{this.usersPresent.delete(s);const t=this.avatarsByUserId.get(s);t&&(null==e||e.removeChild(t),this.avatarsByUserId.delete(s))};this.subscription=r(this,"socket:presence",(e=>{const{data:s}=e.detail,r=this.avatarsByUserId.keys(),n=new Set;for(const{userId:a}of s)t(a),n.add(a);for(const t of r)n.has(t)||a(t)}))}disconnectedCallback(){this.subscription&&this.subscription.unsubscribe()}};e([s],a.prototype,"avatar",void 0),a=e([t],a)}}}));
//# sourceMappingURL=chunk-presence-avatars-cf822872.js.map
